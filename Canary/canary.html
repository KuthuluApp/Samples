<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>KUTHULU Example</title>
    <style>
        div{margin:20px;}
    </style>
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@4.0.0/dist/css/bootstrap.min.css" integrity="sha384-Gn5384xqQ1aoWXA+058RXPxPg6fy4IWvTNh0E263XmFcJlSAwiGgFAW/dAiS6JXm" crossorigin="anonymous">
    <script src="https://code.jquery.com/jquery-3.7.0.min.js" integrity="sha256-2Pmvv0kuTBOenSvLm6bvfBSSHrUJ+3A7x6P5Ebd07/g=" crossorigin="anonymous"></script>
    <script src="https://cdn.jsdelivr.net/gh/ethereum/web3.js/dist/web3.min.js"></script>

    <script>
        const web3 = new Web3(window.ethereum);
        let web3inf = new Web3('https://polygon-mainnet.infura.io/v3/8c82aaa7f7694749bf2643b11eeeb062');

        // Contract Setup
        const contractKUTHULUAddress = '0x1337AF99B61116CE034C1972EEc87cF348Dd668e';
        const abiKUTHULU = [{"inputs":[],"stateMutability":"nonpayable","type":"constructor"},{"anonymous":false,"inputs":[{"indexed":false,"internalType":"uint8","name":"version","type":"uint8"}],"name":"Initialized","type":"event"},{"anonymous":false,"inputs":[{"indexed":true,"internalType":"address","name":"previousOwner","type":"address"},{"indexed":true,"internalType":"address","name":"newOwner","type":"address"}],"name":"OwnershipTransferred","type":"event"},{"anonymous":false,"inputs":[{"indexed":false,"internalType":"address","name":"account","type":"address"}],"name":"Paused","type":"event"},{"anonymous":false,"inputs":[{"indexed":false,"internalType":"address","name":"account","type":"address"}],"name":"Unpaused","type":"event"},{"anonymous":false,"inputs":[{"indexed":false,"internalType":"string","name":"canary","type":"string"}],"name":"logCanary","type":"event"},{"anonymous":false,"inputs":[{"indexed":true,"internalType":"uint256","name":"msgID","type":"uint256"},{"indexed":true,"internalType":"address","name":"poster","type":"address"}],"name":"logEraseMsg","type":"event"},{"anonymous":false,"inputs":[{"indexed":true,"internalType":"uint256","name":"msgID","type":"uint256"},{"indexed":true,"internalType":"address","name":"postedBy","type":"address"},{"indexed":false,"internalType":"string","name":"message","type":"string"},{"indexed":false,"internalType":"string[]","name":"hashtags","type":"string[]"},{"indexed":false,"internalType":"address[]","name":"taggedAccounts","type":"address[]"}],"name":"logMsgPostMsg1","type":"event"},{"anonymous":false,"inputs":[{"indexed":true,"internalType":"uint256","name":"msgID","type":"uint256"},{"indexed":true,"internalType":"address","name":"proxy","type":"address"},{"indexed":false,"internalType":"string","name":"uri","type":"string"},{"indexed":false,"internalType":"uint256[5]","name":"attribs","type":"uint256[5]"},{"indexed":false,"internalType":"uint256[]","name":"inGroups","type":"uint256[]"}],"name":"logMsgPostMsg2","type":"event"},{"inputs":[],"name":"Blocking","outputs":[{"internalType":"contract IBlocking","name":"","type":"address"}],"stateMutability":"view","type":"function"},{"inputs":[],"name":"ContractHook","outputs":[{"internalType":"contract IContractHook","name":"","type":"address"}],"stateMutability":"view","type":"function"},{"inputs":[],"name":"DOOM","outputs":[{"internalType":"contract IDOOM","name":"","type":"address"}],"stateMutability":"view","type":"function"},{"inputs":[],"name":"Groups","outputs":[{"internalType":"contract IGroups","name":"","type":"address"}],"stateMutability":"view","type":"function"},{"inputs":[],"name":"Hashtags","outputs":[{"internalType":"contract IHashtags","name":"","type":"address"}],"stateMutability":"view","type":"function"},{"inputs":[],"name":"KUtils","outputs":[{"internalType":"contract IKUtils","name":"","type":"address"}],"stateMutability":"view","type":"function"},{"inputs":[],"name":"Likes","outputs":[{"internalType":"contract ILikes","name":"","type":"address"}],"stateMutability":"view","type":"function"},{"inputs":[],"name":"MessageData","outputs":[{"internalType":"contract IMessageData","name":"","type":"address"}],"stateMutability":"view","type":"function"},{"inputs":[],"name":"Posts","outputs":[{"internalType":"contract IPosts","name":"","type":"address"}],"stateMutability":"view","type":"function"},{"inputs":[],"name":"Tagged","outputs":[{"internalType":"contract ITagged","name":"","type":"address"}],"stateMutability":"view","type":"function"},{"inputs":[],"name":"Tips","outputs":[{"internalType":"contract ITips","name":"","type":"address"}],"stateMutability":"view","type":"function"},{"inputs":[],"name":"canary","outputs":[{"internalType":"string","name":"","type":"string"}],"stateMutability":"view","type":"function"},{"inputs":[],"name":"costToPost","outputs":[{"internalType":"uint256","name":"","type":"uint256"}],"stateMutability":"view","type":"function"},{"inputs":[],"name":"cutToPoster","outputs":[{"internalType":"uint256","name":"","type":"uint256"}],"stateMutability":"view","type":"function"},{"inputs":[{"internalType":"uint256","name":"msgID","type":"uint256"}],"name":"eraseMsg","outputs":[],"stateMutability":"nonpayable","type":"function"},{"inputs":[{"internalType":"address","name":"addressToFollow","type":"address"}],"name":"followUser","outputs":[],"stateMutability":"nonpayable","type":"function"},{"inputs":[{"internalType":"address","name":"usrAddress","type":"address"},{"internalType":"uint256","name":"startFrom","type":"uint256"},{"internalType":"bool","name":"getUserComments","type":"bool"},{"internalType":"bool","name":"getUserReposts","type":"bool"}],"name":"getMsgIDsByAddress","outputs":[{"internalType":"uint256[]","name":"","type":"uint256[]"}],"stateMutability":"view","type":"function"},{"inputs":[{"internalType":"string","name":"hashtag","type":"string"},{"internalType":"uint256","name":"startFrom","type":"uint256"}],"name":"getMsgIDsByHashtag","outputs":[{"internalType":"uint256[]","name":"","type":"uint256[]"}],"stateMutability":"view","type":"function"},{"inputs":[{"internalType":"address","name":"taggedAddress","type":"address"},{"internalType":"uint256","name":"startFrom","type":"uint256"}],"name":"getMsgIDsByTag","outputs":[{"internalType":"uint256[]","name":"","type":"uint256[]"}],"stateMutability":"view","type":"function"},{"inputs":[{"internalType":"uint256[]","name":"msgIDs","type":"uint256[]"},{"internalType":"bool","name":"onlyFollowers","type":"bool"},{"internalType":"address","name":"userToCheck","type":"address"}],"name":"getMsgsByIDs","outputs":[{"internalType":"string[][]","name":"","type":"string[][]"}],"stateMutability":"view","type":"function"},{"inputs":[],"name":"getStats","outputs":[{"internalType":"uint256[]","name":"","type":"uint256[]"}],"stateMutability":"view","type":"function"},{"inputs":[{"internalType":"uint256","name":"msgID","type":"uint256"},{"internalType":"uint256","name":"startFrom","type":"uint256"},{"internalType":"bool","name":"isRepost","type":"bool"}],"name":"getSubIDsByPost","outputs":[{"internalType":"uint256[]","name":"","type":"uint256[]"}],"stateMutability":"view","type":"function"},{"inputs":[{"internalType":"contract IERC20Upgradeable","name":"_paymentToken","type":"address"},{"internalType":"address","name":"_userProfiles","type":"address"},{"internalType":"address","name":"_kutils","type":"address"},{"internalType":"uint256","name":"_costToPost","type":"uint256"},{"internalType":"uint256[2]","name":"_maxMessageLength","type":"uint256[2]"},{"internalType":"uint256","name":"_maxMsgReturnCount","type":"uint256"},{"internalType":"uint256","name":"_cutToPoster","type":"uint256"},{"internalType":"uint256","name":"_maxGroups","type":"uint256"},{"internalType":"uint256","name":"_postToEarnCap","type":"uint256"}],"name":"initialize","outputs":[],"stateMutability":"nonpayable","type":"function"},{"inputs":[],"name":"maxGroups","outputs":[{"internalType":"uint256","name":"","type":"uint256"}],"stateMutability":"view","type":"function"},{"inputs":[{"internalType":"uint256","name":"","type":"uint256"}],"name":"maxMessageLength","outputs":[{"internalType":"uint256","name":"","type":"uint256"}],"stateMutability":"view","type":"function"},{"inputs":[],"name":"maxMsgReturnCount","outputs":[{"internalType":"uint256","name":"","type":"uint256"}],"stateMutability":"view","type":"function"},{"inputs":[],"name":"owner","outputs":[{"internalType":"address","name":"","type":"address"}],"stateMutability":"view","type":"function"},{"inputs":[],"name":"pause","outputs":[],"stateMutability":"nonpayable","type":"function"},{"inputs":[],"name":"paused","outputs":[{"internalType":"bool","name":"","type":"bool"}],"stateMutability":"view","type":"function"},{"inputs":[],"name":"paymentToken","outputs":[{"internalType":"contract IERC20Upgradeable","name":"","type":"address"}],"stateMutability":"view","type":"function"},{"inputs":[{"internalType":"string","name":"message","type":"string"},{"internalType":"string[]","name":"_hashtags","type":"string[]"},{"internalType":"address[]","name":"taggedAccounts","type":"address[]"},{"internalType":"string","name":"uri","type":"string"},{"internalType":"uint256[5]","name":"attribs","type":"uint256[5]"},{"internalType":"uint256[]","name":"inGroups","type":"uint256[]"}],"name":"postMsg","outputs":[],"stateMutability":"payable","type":"function"},{"inputs":[],"name":"postToEarnCap","outputs":[{"internalType":"uint256","name":"","type":"uint256"}],"stateMutability":"view","type":"function"},{"inputs":[{"internalType":"address","name":"","type":"address"}],"name":"privateEnterWhitelist","outputs":[{"internalType":"bool","name":"","type":"bool"}],"stateMutability":"view","type":"function"},{"inputs":[],"name":"renounceOwnership","outputs":[],"stateMutability":"nonpayable","type":"function"},{"inputs":[{"internalType":"uint256","name":"_maxMsgReturnCount","type":"uint256"},{"internalType":"uint256[2]","name":"_maxMessageLength","type":"uint256[2]"},{"internalType":"uint256","name":"_maxGroups","type":"uint256"},{"internalType":"uint256","name":"_postToEarnCap","type":"uint256"}],"name":"setParams","outputs":[],"stateMutability":"nonpayable","type":"function"},{"inputs":[{"internalType":"uint256","name":"msgID","type":"uint256"}],"name":"toggleLike","outputs":[],"stateMutability":"nonpayable","type":"function"},{"inputs":[{"internalType":"address","name":"newOwner","type":"address"}],"name":"transferOwnership","outputs":[],"stateMutability":"nonpayable","type":"function"},{"inputs":[{"internalType":"address","name":"addressToUnFollow","type":"address"}],"name":"unfollowUser","outputs":[],"stateMutability":"nonpayable","type":"function"},{"inputs":[],"name":"unpause","outputs":[],"stateMutability":"nonpayable","type":"function"},{"inputs":[{"internalType":"address","name":"admin","type":"address"},{"internalType":"bool","name":"status","type":"bool"}],"name":"updateAdmin","outputs":[],"stateMutability":"nonpayable","type":"function"},{"inputs":[{"internalType":"string","name":"_canary","type":"string"}],"name":"updateCanary","outputs":[],"stateMutability":"nonpayable","type":"function"},{"inputs":[{"internalType":"contract IERC20Upgradeable","name":"_payments","type":"address"},{"internalType":"address[]","name":"contracts","type":"address[]"}],"name":"updateContracts","outputs":[],"stateMutability":"nonpayable","type":"function"},{"inputs":[{"internalType":"uint256","name":"_costToPost","type":"uint256"},{"internalType":"uint256","name":"_cutToPoster","type":"uint256"}],"name":"updateCosts","outputs":[],"stateMutability":"nonpayable","type":"function"},{"inputs":[{"internalType":"address","name":"wl","type":"address"},{"internalType":"bool","name":"status","type":"bool"}],"name":"updatePrivateWhitelist","outputs":[],"stateMutability":"nonpayable","type":"function"},{"inputs":[],"name":"userProfiles","outputs":[{"internalType":"contract IUserProfiles","name":"","type":"address"}],"stateMutability":"view","type":"function"}];
        const contractKUTHULU = new web3inf.eth.Contract(abiKUTHULU, contractKUTHULUAddress);

        // Contract Call
        async function getCanary() {
            let canary = await contractKUTHULU.methods.canary().call()
                .then(result => {
                    $('#canary').html(result);
                    return result;
                })
                .catch(err => {
                    console.log(err);
                });

            if (canary === 'safe'){
                alert("we're good!");
            } else {
                alert("we're NOT good!");
            }
        }
    </script>
</head>
<body>

<div>
    <h1>Canary Example</h1>

    <div id="canary" style="color:green;"></div>
</div>

<script>getCanary();</script>

</body>
</html>